logic enhancement

SD2 adds his logic
