logic enhancement


SD2 adds his logic

SD1 adds logic

